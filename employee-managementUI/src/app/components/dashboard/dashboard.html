<!-- Top Summary Cards -->
<div class="row mb-4">
  <!-- Total Employees -->
  <div class="col-lg-3 col-md-6 mb-3">
    <div class="card text-center shadow-sm" style="background-color: azure;">
      <div class="card-body">
        <h5>Total Employees</h5>
        <p class="display-6">{{ totalEmployees }}</p>
      </div>
    </div>
  </div>

  <!-- Birthdays -->
  <div class="col-lg-3 col-md-6 mb-3">
    <div class="card text-center shadow-sm" style="background-color: antiquewhite;">
      <div class="card-body">
        <h5>Today's Birthdays</h5>
        <p class="display-6">{{ birthdaysToday }}</p>
      </div>
    </div>
  </div>
  <!-- Pending Approvals -->
   <div class="col-lg-3 col-md-6 mb-3">
    <div class="card text-center shadow-sm" style="background-color: orange;">
      <div class="card-body">
        <h5>Pending Approvals</h5>
        <p class="display-6">{{ pendingCount }}</p>

        <!-- <button class="btn btn-sm btn-dark view-button" (click)="openDialog()">View</button> -->
         <button class="btn btn-sm view-button" (click)="openPendingModal()">View</button>
      </div>
    </div>
    <div class="modal-backdrop" *ngIf="showPendingModal" (click)="showPendingModal = false"></div>

  <div class="modal-content-wrapper" *ngIf="showPendingModal">
      <div class="modal-header">
        <h5 style="text-align: center;">Pending Leave Requests</h5>
        <button class="close-btn" (click)="closePendingModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div *ngIf="pendingReqs.length > 0; else emptyState"></div>
        <div>
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Emplyoee Name</th>
                <th>Leave type</th>
                <th>From</th>
                <th>To</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let req of pendingReqs">
                <td>{{ req.employeeName }}</td>
                <td>{{ req.leaveType }}</td>
                <td>{{ req.from | date }}</td>
                <td>{{ req.to | date }}</td>
                <td>
                  <span [ngClass]="[
                    'badge',
                    req.status === 'Pending' ? 'bg-warning text-dark' : ''
                  ]">
                  {{ req.status }}
                  </span>
                </td>
                <td>
                  <button class="btn btn-sm btn-success me-1" *ngIf="req.status === 'Pending'" (click)="approveLeave(req.id!)">Approve</button>
                  <button class="btn btn-sm btn-danger me-1" *ngIf="req.status === 'Pending'" (click)="rejectLeave(req.id!)">Reject</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <ng-template #emptyState>
          <p class="text-muted">No pending requests to show.</p>
        </ng-template>
      </div>
    
  </div>
  </div>

  <!-- Todo List-->
  <div class="col-lg-3 col-md-6 mb-3">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5>To-Do List</h5>
        <ul class="list-unstyled">
          <li *ngFor="let item of todoList">âœ… {{ item.title }}</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- Employee Directory + Sidebar Cards -->
<div class="row">
  <!-- Employee Directory -->
  <div class="col-md-8 mb-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5>Employee Directory</h5>
        <div class="d-flex">
            <input [(ngModel)]="searchTerm" class="form-control mb-3" placeholder="Search employee..." />
        </div>
        
        <div *ngFor="let emp of emps.slice(0, 10) | filter:searchTerm" class="d-flex align-items-center mb-3 border-bottom pb-2">
            <img [src]="apiBaseUrl + emp.photoUrl" alt="{{ emp.employeeId }}" class="rounded-circle me-3" width="50" height="50" />
            <div>
                <a [routerLink]="['/employees', emp.id]" class="employee-link">
                <strong >{{ emp.firstName }} {{ emp.lastName }}</strong><br>
                <span class="text-muted">{{ emp.department }}</span>
                </a>
            </div>
            </div>

            <button *ngIf="employees.length > 10" class="btn btn-outline-primary btn-sm mt-2">
            View All
            </button>
      </div>
    </div>
  </div>

  <!-- Quick Actions + Notifications -->
  <div class="col-md-4">
    <!-- Quick Actions -->
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <h5>Quick Actions</h5>
        <a [routerLink]="['/create-employee']"  class="btn btn-sm btn-success w-100 mb-2">Add Employee</a>
        <!--<button class="btn btn-primary w-100 mb-2">Add Employee</button>-->
        <button class="btn btn-sm btn-warning w-100">View Payroll</button>
      </div>
    </div>

    <!-- Notifications -->
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <h5>Notifications</h5>
        <ul class="list-unstyled">
          <li *ngFor="let note of notifications">ðŸ“£ {{ note.localName }} - {{ note.date | date: 'MMM d'}}</li>
        </ul>
      </div>
    </div>

    <!-- Calender-->
    <mat-card class="calendar-container">
      <mat-calendar *ngIf="holidaysLoaded && eventsLoaded"
        (selectedChange)="onDateClick($event)"
        [dateClass]="dateClass">
      </mat-calendar>
    </mat-card>
    
  </div>
</div>
